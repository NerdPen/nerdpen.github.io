{"version":3,"file":"fields/index.js?t=890dbe3d038602589aeb","mappings":"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","sources":["webpack://91app-payment-sdk/./src/config/index.ts","webpack://91app-payment-sdk/./src/events/eventEmitter.ts","webpack://91app-payment-sdk/./src/events/postMessageEmitter.ts","webpack://91app-payment-sdk/./src/payments/creditCard/enums/index.ts","webpack://91app-payment-sdk/./src/payments/creditCard/utilities/index.ts","webpack://91app-payment-sdk/./src/payments/fields/components/baseField.ts","webpack://91app-payment-sdk/./src/payments/fields/components/ccvField.ts","webpack://91app-payment-sdk/./src/payments/fields/components/expirationDateField.ts","webpack://91app-payment-sdk/./src/payments/fields/components/numberField.ts","webpack://91app-payment-sdk/./src/payments/fields/enums/index.ts","webpack://91app-payment-sdk/./src/services/creditCard.service.ts","webpack://91app-payment-sdk/webpack/bootstrap","webpack://91app-payment-sdk/./src/payments/fields/index.ts"],"sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Config = void 0;\nconst eventEmitter_1 = require(\"@/src/events/eventEmitter\");\nclass Config extends eventEmitter_1.EventEmitter {\n    constructor() {\n        super();\n        this._clientData = null;\n        this._origin = {\n            sandbox: 'https://gadget.payment.qa.91dev.tw',\n            production: 'https://gadget.payment.91app.com',\n        };\n    }\n    static getInstance() {\n        if (!Config._instance)\n            Config._instance = new Config();\n        return Config._instance;\n    }\n    set clientData(data) {\n        this._clientData = Object.assign({}, data);\n    }\n    get clientData() {\n        return this._clientData;\n    }\n    get version() {\n        return process.env.VERSION;\n    }\n    get origin() {\n        return process.env.NODE_ENV === 'development'\n            ? '*'\n            : this._origin[this.clientData.serverType];\n    }\n    get apiDomain() {\n        return this._origin[this.clientData.serverType];\n    }\n    get iframeDomain() {\n        return process.env.NODE_ENV === 'development'\n            ? 'http://localhost:8001'\n            : `./${this.version}`;\n    }\n}\nexports.Config = Config;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.EventEmitter = void 0;\nclass EventEmitter {\n    constructor() {\n        this.listeners = new Map();\n    }\n    on(event, callback) {\n        if (!this.listeners.has(event)) {\n            this.listeners.set(event, [callback]);\n        }\n        else {\n            this.listeners.get(event).push(callback);\n        }\n    }\n    emit(event, payload) {\n        if (!this.listeners.has(event))\n            return;\n        const callbacks = this.listeners.get(event);\n        callbacks.forEach((callback) => {\n            callback(payload);\n        });\n    }\n    off(event) {\n        if (this.listeners.has(event)) {\n            this.listeners.delete(event);\n        }\n    }\n}\nexports.EventEmitter = EventEmitter;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.PostMessageEmitter = void 0;\nclass PostMessageEmitter {\n    constructor(current, target, origin) {\n        this.current = current;\n        this.target = target;\n        this.origin = origin;\n        this.listeners = new Map();\n        this.current.addEventListener('message', (evt) => {\n            const { type, payload } = evt.data;\n            if (this.listeners.get(type)) {\n                const callbacks = this.listeners.get(type);\n                callbacks.forEach((callback) => {\n                    callback(payload);\n                });\n            }\n        });\n    }\n    on(event, callback) {\n        if (!this.listeners.get(event)) {\n            this.listeners.set(event, [callback]);\n        }\n    }\n    emit(event, payload) {\n        const message = {\n            type: event,\n            payload,\n        };\n        this.target.postMessage(message, this.origin);\n    }\n    registerEvent(event) {\n        const eventBinder = (handler) => {\n            return this.on(event, handler);\n        };\n        return eventBinder;\n    }\n}\nexports.PostMessageEmitter = PostMessageEmitter;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.CardBrand = void 0;\nvar CardBrand;\n(function (CardBrand) {\n    CardBrand[\"Unknown\"] = \"Unknown\";\n    CardBrand[\"MasterCard\"] = \"MasterCard\";\n    CardBrand[\"VISA\"] = \"VISA\";\n    CardBrand[\"JCB\"] = \"JCB\";\n    CardBrand[\"AMEX\"] = \"AMEX\";\n    CardBrand[\"UnionPay\"] = \"UnionPay\";\n})(CardBrand = exports.CardBrand || (exports.CardBrand = {}));\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.getCardBrand = void 0;\nconst enums_1 = require(\"@/payments/creditCard/enums\");\nconst getCardBrand = (value) => {\n    const patterns = {\n        [enums_1.CardBrand.AMEX]: /^3[47][0-9]{13}$/,\n        [enums_1.CardBrand.VISA]: /^4/,\n        [enums_1.CardBrand.MasterCard]: /^5[1-5]/,\n        [enums_1.CardBrand.JCB]: /^35/,\n        [enums_1.CardBrand.UnionPay]: /^62/,\n    };\n    let cardBrand = enums_1.CardBrand.Unknown;\n    Object.keys(patterns).forEach((key) => {\n        if (patterns[key].test(value))\n            cardBrand = key;\n    });\n    return cardBrand;\n};\nexports.getCardBrand = getCardBrand;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.BaseField = void 0;\nconst postMessageEmitter_1 = require(\"@/src/events/postMessageEmitter\");\nconst enums_1 = require(\"@/payments/creditCard/enums\");\nconst enums_2 = require(\"@/payments/fields/enums\");\nconst creditCard_service_1 = require(\"@/src/services/creditCard.service\");\nconst config_1 = require(\"@/src/config\");\nclass BaseField extends postMessageEmitter_1.PostMessageEmitter {\n    constructor(params) {\n        super(window, window.parent, '*');\n        this.params = params;\n        this._status = enums_2.FieldStatus.Normal;\n        this._cardBrand = enums_1.CardBrand.Unknown;\n        const id = `field-${params.type}`;\n        this._element = document.getElementById(id);\n        if (params.placeholder) {\n            this._element.placeholder = params.placeholder;\n        }\n        this._element.addEventListener('foucs', this.onFocus.bind(this));\n        this._element.addEventListener('blur', this.onBlur.bind(this));\n        this._element.addEventListener('input', this.onChange.bind(this));\n        this.listenParentMessage();\n    }\n    listenParentMessage() {\n        this.on('FOCUS_FIELD', () => this.element.focus());\n        this.on('SYNC_CLIENT', (clientData) => {\n            config_1.Config.getInstance().clientData = clientData;\n        });\n        this.on('SYNC_CARD_BRAND', (cardBrand) => {\n            this.cardBrand = cardBrand;\n        });\n        this.on('GET_TOKEN', (data) => {\n            (0, creditCard_service_1.getTxnToken)(data).then((result) => {\n                this.emit('GET_TOKEN_COMPLETED', result);\n            });\n        });\n    }\n    removeUnlegalCharacter() {\n        const isLegal = /^[0-9\\s/]+$/;\n        if (!isLegal.test(this._element.value)) {\n            this._element.value = this._element.value.slice(0, -1);\n        }\n    }\n    validate() {\n        if (this.status === enums_2.FieldStatus.Success) {\n            this.element.classList.remove('invalid');\n            this.element.classList.add('valid');\n        }\n        if (this.status === enums_2.FieldStatus.Error) {\n            this.element.classList.remove('valid');\n            this.element.classList.add('invalid');\n        }\n    }\n    getErrorMessage() {\n        return '';\n    }\n    getUnformattedValue() {\n        return this.element.value;\n    }\n    formatValue() {\n        if (!this.element.value.length)\n            return;\n    }\n    onFocus(evt) { }\n    onBlur(evt) { }\n    onChange(evt) {\n        this.removeUnlegalCharacter();\n        this.validate();\n        this.formatValue();\n        const update = {\n            type: this.params.type,\n            status: this.status,\n            value: this.getUnformattedValue(),\n            errorMessage: this.getErrorMessage(),\n        };\n        this.emit('UPDATE_FIELD', update);\n    }\n    get element() {\n        return this._element;\n    }\n    set status(status) {\n        this._status = status;\n    }\n    get status() {\n        return this._status;\n    }\n    get cardBrand() {\n        return this._cardBrand;\n    }\n    set cardBrand(brand) {\n        this._cardBrand = brand;\n    }\n}\nexports.BaseField = BaseField;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.CCVField = void 0;\nconst enums_1 = require(\"@/payments/creditCard/enums\");\nconst enums_2 = require(\"@/payments/fields/enums\");\nconst baseField_1 = require(\"@/payments/fields/components/baseField\");\nclass CCVField extends baseField_1.BaseField {\n    constructor(params) {\n        super(params);\n        this.params = params;\n    }\n    validate() {\n        const length = this.cardBrand === enums_1.CardBrand.AMEX ? 4 : 3;\n        this.status =\n            this.element.value.length === length\n                ? enums_2.FieldStatus.Success\n                : enums_2.FieldStatus.Error;\n        super.validate();\n    }\n    getErrorMessage() {\n        return this.status === enums_2.FieldStatus.Error ? '背面末三碼未填或格式錯誤' : '';\n    }\n}\nexports.CCVField = CCVField;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.ExpirationDateField = void 0;\nconst enums_1 = require(\"@/payments/fields/enums\");\nconst baseField_1 = require(\"@/payments/fields/components/baseField\");\nclass ExpirationDateField extends baseField_1.BaseField {\n    constructor(params) {\n        super(params);\n        this.params = params;\n    }\n    validate() {\n        const month = this.element.value.replace('/', '').slice(0, 2);\n        const monthParten = /(^0?[1-9]$)|(^1[0-2]$)/;\n        const year = this.element.value.replace('/', '').slice(2, 4);\n        const minYear = +new Date().getFullYear().toString().slice(2, 4);\n        const maxYear = +new Date().getFullYear().toString().slice(2, 4) + 30;\n        this.status =\n            monthParten.test(month) && +year >= minYear && +year < maxYear\n                ? enums_1.FieldStatus.Success\n                : enums_1.FieldStatus.Error;\n        super.validate();\n    }\n    getErrorMessage() {\n        return this.status === enums_1.FieldStatus.Error ? '有效期限未填或格式錯誤' : '';\n    }\n    formatValue() {\n        super.formatValue();\n        const split = this.element.value\n            .replace('/', '')\n            .slice(0, 4)\n            .match(/.{1,2}/g);\n        this.element.value = split ? split.join('/') : this.element.value;\n    }\n    getUnformattedValue() {\n        return this.element.value.replace('/', '');\n    }\n}\nexports.ExpirationDateField = ExpirationDateField;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.NumberField = void 0;\nconst enums_1 = require(\"@/payments/creditCard/enums\");\nconst utilities_1 = require(\"@/payments/creditCard/utilities\");\nconst enums_2 = require(\"@/payments/fields/enums\");\nconst baseField_1 = require(\"@/payments/fields/components/baseField\");\nclass NumberField extends baseField_1.BaseField {\n    constructor(params) {\n        super(params);\n        this.params = params;\n    }\n    validate() {\n        const patterns = {\n            [enums_1.CardBrand.Unknown]: /^[0-9]{18}$/,\n            [enums_1.CardBrand.AMEX]: /^3[47][0-9]{13}$/,\n            [enums_1.CardBrand.VISA]: /^4[0-9]{15}$/,\n            [enums_1.CardBrand.MasterCard]: /^5[1-5][0-9]{14}$/,\n            [enums_1.CardBrand.JCB]: /^35[0-9]{14}$/,\n            [enums_1.CardBrand.UnionPay]: /^62[0-9]{14,17}$/,\n        };\n        this.status =\n            patterns[this.cardBrand].test(this.element.value.replace(/\\s/g, '')) && this.cardBrand !== enums_1.CardBrand.UnionPay\n                ? enums_2.FieldStatus.Success\n                : enums_2.FieldStatus.Error;\n        super.validate();\n    }\n    getErrorMessage() {\n        if (this.cardBrand === enums_1.CardBrand.UnionPay) {\n            return '暫不支援此信用卡';\n        }\n        return this.status === enums_2.FieldStatus.Error ? '卡號未填或格式錯誤' : '';\n    }\n    formatValue() {\n        super.formatValue();\n        const split = this.element.value.replace(/\\s/g, '').match(/.{1,4}/g);\n        this.element.value = split ? split.join(' ') : this.element.value;\n    }\n    getUnformattedValue() {\n        return this.element.value.replace(/\\s/g, '');\n    }\n    onChange(evt) {\n        this.cardBrand = (0, utilities_1.getCardBrand)(evt.target.value);\n        this.emit('UPDATE_CARD_BRAND', this.cardBrand);\n        super.onChange(evt);\n    }\n}\nexports.NumberField = NumberField;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.FieldStatus = void 0;\nvar FieldStatus;\n(function (FieldStatus) {\n    FieldStatus[FieldStatus[\"Normal\"] = 0] = \"Normal\";\n    FieldStatus[FieldStatus[\"Success\"] = 1] = \"Success\";\n    FieldStatus[FieldStatus[\"Error\"] = -1] = \"Error\";\n})(FieldStatus = exports.FieldStatus || (exports.FieldStatus = {}));\n","\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.getTxnToken = void 0;\nconst config_1 = require(\"../config\");\nconst getTxnToken = (data) => __awaiter(void 0, void 0, void 0, function* () {\n    try {\n        const requestUrl = `${config_1.Config.getInstance().apiDomain}/api/Payment/GetTxnToken`;\n        const response = yield fetch(requestUrl, {\n            body: JSON.stringify(data),\n            method: 'POST',\n            headers: {\n                'content-type': 'application/json',\n            },\n        });\n        return Promise.resolve(response.json());\n    }\n    catch (error) {\n        return Promise.reject(error);\n    }\n});\nexports.getTxnToken = getTxnToken;\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst numberField_1 = require(\"@/payments/fields/components/numberField\");\nconst expirationDateField_1 = require(\"@/payments/fields/components/expirationDateField\");\nconst ccvField_1 = require(\"@/payments/fields/components/ccvField\");\ndocument.addEventListener('DOMContentLoaded', () => {\n    if (!window.location.search.length)\n        return;\n    const params = JSON.parse(decodeURIComponent(window.location.search.replace('?', '')));\n    [].forEach.call(document.querySelectorAll('form'), (form) => {\n        if (form.id !== `${params.type}-form`) {\n            form.remove();\n        }\n    });\n    let currentField;\n    if (params.type === 'number') {\n        currentField = new numberField_1.NumberField(params);\n    }\n    if (params.type === 'expirationDate') {\n        currentField = new expirationDateField_1.ExpirationDateField(params);\n    }\n    if (params.type === 'ccv') {\n        currentField = new ccvField_1.CCVField(params);\n    }\n});\n"],"names":["Object","defineProperty","exports","value","Config","eventEmitter_1","EventEmitter","constructor","super","this","_clientData","_origin","sandbox","production","static","_instance","clientData","data","assign","version","origin","serverType","apiDomain","iframeDomain","listeners","Map","on","event","callback","has","get","push","set","emit","payload","forEach","off","delete","PostMessageEmitter","current","target","addEventListener","evt","type","message","postMessage","registerEvent","handler","CardBrand","getCardBrand","enums_1","patterns","AMEX","VISA","MasterCard","JCB","UnionPay","cardBrand","Unknown","keys","key","test","BaseField","postMessageEmitter_1","enums_2","creditCard_service_1","config_1","params","window","parent","_status","FieldStatus","Normal","_cardBrand","id","_element","document","getElementById","placeholder","onFocus","bind","onBlur","onChange","listenParentMessage","element","focus","getInstance","getTxnToken","then","result","removeUnlegalCharacter","slice","validate","status","Success","classList","remove","add","Error","getErrorMessage","getUnformattedValue","formatValue","length","update","errorMessage","brand","CCVField","baseField_1","ExpirationDateField","month","replace","year","minYear","Date","getFullYear","toString","maxYear","split","match","join","NumberField","utilities_1","__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","step","next","e","rejected","done","apply","requestUrl","response","fetch","body","JSON","stringify","method","headers","json","error","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","module","__webpack_modules__","call","numberField_1","expirationDateField_1","ccvField_1","location","search","parse","decodeURIComponent","currentField","querySelectorAll","form"],"sourceRoot":""}